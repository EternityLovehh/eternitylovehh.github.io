<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>王大人的博客</title><meta name="author" content="王大人"><meta name="copyright" content="王大人"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="王大人的博客">
<meta property="og:url" content="https://eternitylovehh.github.io/index.html">
<meta property="og:site_name" content="王大人的博客">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://eternitylovehh.github.io/null">
<meta property="article:author" content="王大人">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://eternitylovehh.github.io/null"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://eternitylovehh.github.io/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-02-26 00:02:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">王大人的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">王大人的博客</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/02/25/binder%E6%9C%BA%E5%88%B6/" title="binder机制">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="binder机制"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/25/binder%E6%9C%BA%E5%88%B6/" title="binder机制">binder机制</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-25T05:44:20.000Z" title="发表于 2021-02-25 13:44:20">2021-02-25</time></span></div><div class="content">安卓为什么要使用binder通信？
采用C/S的通信模式

binder对比linux的通信机制，有以下优点：
scoket 是一个通用接口，导致其传输速率低，开销大；
管道和消息队列  采取存储转发方式，至少需要拷贝2次数据，效率低， 而binder只需要一次数据拷贝；
共享内存 虽然在传输时没有拷贝数据，但是控制机制复杂。

安全性更高 ，binder机制的uid/pid 是由binder机制本身在内核空间添加身份标识，安全性高，并且binder机制可以建立私有通道。


binder通信机制流程
从图中可以看到，binder的通信框架包含了四个重要的角色： Server， Client， ServerManager和binder驱动；client 和server是存在于用户空间，它们之间的通信是由binder驱动在内核空间实现的，而ServerManager作为守护进程也存在于用户空间，处理客户端请求和管理所有的服务项， binder驱动工作在内核中，负责进程间通信的建立。
binder通信原理binder通信只需要copy一次数据的原理是使用了内存映射 mmap() 
内存映射 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/02/24/HashMap%E5%8E%9F%E7%90%86/" title="HashMap 原理">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HashMap 原理"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/24/HashMap%E5%8E%9F%E7%90%86/" title="HashMap 原理">HashMap 原理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-24T02:24:48.277Z" title="发表于 2021-02-24 10:24:48">2021-02-24</time></span></div><div class="content">HashMap 实际上是数组+链表组合构成的数据结构
hash函数的原理    java中任何对象都有hash值，计算key的hash值， 对key的hashcode进行移位，异或运算（相同为0，不同为1），然后通过hash函数计算的index找到数组的位置（求模运算 hash % length, hash&amp;length - 1）。流程如下：**hash函数作用是为了保证最终获取的存储位置尽量分布均匀。
put方法原理     由key得到hash值，根据hash值，得到数组的下标index，找到对应的entry, 判断table[i] 和 entry 的key值和hash值是否相等，相等就用put传入的value替换原value。如果没有找到entry，就创建一个新节点entry  (创建节点，new Entry(key, value, hash, entry)，这里是因为有可能table[i] 下面已经存在节点或者是链表，这个 时候，创建一个新的entry，将entry的next指针指向第一个节点，并且将新建的节点entry作为table[i]的第一个节点table[i]  ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/02/24/hello-world/" title="Hello World">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/24/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-24T02:10:41.326Z" title="发表于 2021-02-24 10:10:41">2021-02-24</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo generate

More info: Generating
Deploy to remote sites1$ hexo deploy

More info: Deployment
</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/02/22/handle%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/" title="handle消息处理机制">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="handle消息处理机制"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/02/22/handle%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/" title="handle消息处理机制">handle消息处理机制</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-02-22T09:19:37.000Z" title="发表于 2021-02-22 17:19:37">2021-02-22</time></span></div><div class="content">HandlerHandler 构造方法中会默认关联当前线程的Looper对象，一个线程只能有一个Looper对象，但是可以有多个handler关联这个looper对象，handler也提供一些构造方法关联自定义的Looper对象。子线程中默认是没有开启looper轮循器的，没有关联的messageQueue管理消息。在子线程中创建handler，需要在looper.prepare() 之后，looper.loop()之前。
LooperLooper即消息循环器，它可以将一个普通线程转换为一个Looper线程， Looper.prepare()方法将线程初始化为Looper线程，该方法在线程中将Looper对象定义为ThreadLocal对象，使得looper对象成为该线程的私有对象。ThreadLocal可以包装一个对象，使其成为线程私有的局部变量，通过ThreadLocal的get和set方法来访问这个线程局部变量，而不受其他线程的影响。
Messagemessage应该使用Message.obtain()方法从一个全局的消息池中得到空的message对象，这样可以有效的节省系统资源 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">王大人</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/02/25/binder%E6%9C%BA%E5%88%B6/" title="binder机制"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="binder机制"/></a><div class="content"><a class="title" href="/2021/02/25/binder%E6%9C%BA%E5%88%B6/" title="binder机制">binder机制</a><time datetime="2021-02-25T05:44:20.000Z" title="发表于 2021-02-25 13:44:20">2021-02-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/24/HashMap%E5%8E%9F%E7%90%86/" title="HashMap 原理"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HashMap 原理"/></a><div class="content"><a class="title" href="/2021/02/24/HashMap%E5%8E%9F%E7%90%86/" title="HashMap 原理">HashMap 原理</a><time datetime="2021-02-24T02:24:48.277Z" title="发表于 2021-02-24 10:24:48">2021-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/24/hello-world/" title="Hello World"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2021/02/24/hello-world/" title="Hello World">Hello World</a><time datetime="2021-02-24T02:10:41.326Z" title="发表于 2021-02-24 10:10:41">2021-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/22/handle%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/" title="handle消息处理机制"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="handle消息处理机制"/></a><div class="content"><a class="title" href="/2021/02/22/handle%E6%B6%88%E6%81%AF%E6%9C%BA%E5%88%B6/" title="handle消息处理机制">handle消息处理机制</a><time datetime="2021-02-22T09:19:37.000Z" title="发表于 2021-02-22 17:19:37">2021-02-22</time></div></div></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span class="card-archive-list-date">二月 2021</span><span class="card-archive-list-count">4</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">4</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-02-25T16:02:37.694Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 王大人</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>